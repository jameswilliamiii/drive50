<div class="dashboard">
  <div class="progress-summary">
    <div class="stat-card">
      <h2><%= @total_hours.round(1) %> / 50</h2>
      <p>Total Hours</p>
      <% if @hours_needed > 0 %>
        <small><%= @hours_needed.round(1) %> hours remaining</small>
      <% else %>
        <small class="complete">âœ“ Complete!</small>
      <% end %>
    </div>

    <div class="stat-card">
      <h2><%= @night_hours.round(1) %> / 10</h2>
      <p>Night Hours</p>
      <% if @night_hours_needed > 0 %>
        <small><%= @night_hours_needed.round(1) %> hours remaining</small>
      <% else %>
        <small class="complete">âœ“ Complete!</small>
      <% end %>
    </div>
  </div>

  <% if @in_progress %>
    <div class="in-progress-drive">
      <h3>Drive in Progress</h3>
      <p>
        <strong>Started:</strong> <%= @in_progress.started_at.strftime("%b %d, %Y at %I:%M %p") %>
      </p>
      <p>
        <strong>Driver:</strong> <%= @in_progress.driver_name %>
      </p>
      <%= button_to "Complete Drive", complete_drive_session_path(@in_progress),
                    class: "button-primary" %>
      <%= link_to "Edit", edit_drive_session_path(@in_progress), class: "button" %>
    </div>
  <% else %>
    <div class="actions">
      <%= link_to "Start New Drive", new_drive_session_path, class: "button-primary button-large" %>
      <%= link_to "Export Log (CSV)", export_drive_sessions_path(format: :csv), class: "button" %>
    </div>
  <% end %>

  <div class="drive-history">
    <h3>Recent Drives</h3>

    <% if @sessions.any? %>
      <table>
        <thead>
          <tr>
            <th>Date</th>
            <th>Driver</th>
            <th>Duration</th>
            <th>Night</th>
            <th>Supervisor</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <% @sessions.each do |session| %>
            <tr>
              <td><%= session.started_at.strftime("%b %d, %Y") %></td>
              <td><%= session.driver_name %></td>
              <td><%= session.duration_hours %> hrs</td>
              <td><%= session.is_night_drive ? "ðŸŒ™" : "â˜€ï¸" %></td>
              <td><%= session.supervisor_name %></td>
              <td class="actions">
                <%= link_to "Edit", edit_drive_session_path(session) %>
                <%= button_to "Delete", drive_session_path(session),
                              method: :delete,
                              data: { turbo_confirm: "Are you sure?" },
                              class: "link-danger" %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    <% else %>
      <p class="empty-state">No drives recorded yet. Start your first drive!</p>
    <% end %>
  </div>
</div>

