<div class="dashboard">
  <div class="progress-summary">
    <% if @in_progress %>
      <div class="in-progress-drive stat-card" data-controller="timer" data-timer-started-at-value="<%= @in_progress.started_at.iso8601 %>">
        <div class="drive-duration">
          <span class="duration-value" data-timer-target="display"><%= @in_progress.elapsed_time %></span>
        </div>
        <p>Drive in Progress</p>
        <div class="drive-actions">
          <%= button_to "Complete Drive", complete_drive_session_path(@in_progress),
                        class: "button-primary" %>
          <%= link_to "Edit", edit_drive_session_path(@in_progress), class: "button" %>
        </div>
      </div>
    <% end %>
    <div class="stat-card">
      <h2><%= @total_hours.round(1) %> / 50</h2>
      <p>
        Total Hours
        <span class="tooltip-trigger" data-tooltip="Illinois requires 50 hours total of supervised driving practice">
          <%= icon_info(size: 14, class: "info-icon") %>
        </span>
      </p>
      <% if @hours_needed > 0 %>
        <small><%= @hours_needed.round(1) %> hours remaining</small>
      <% else %>
        <small class="complete"><%= icon_check(size: 16, class: "check-icon") %> Complete!</small>
      <% end %>
    </div>

    <div class="stat-card">
      <h2><%= @night_hours.round(1) %> / 10</h2>
      <p>
        Night Hours
        <span class="tooltip-trigger" data-tooltip="Illinois requires 10 hours of night driving (between sunset and sunrise)">
          <%= icon_info(size: 14, class: "info-icon") %>
        </span>
      </p>
      <% if @night_hours_needed > 0 %>
        <small><%= @night_hours_needed.round(1) %> hours remaining</small>
      <% else %>
        <small class="complete"><%= icon_check(size: 16, class: "check-icon") %> Complete!</small>
      <% end %>
    </div>
  </div>

  <div class="drive-history">
    <h3>Recent Drives</h3>
    <% if Current.user.drive_sessions.completed.any? %>
      <table>
        <thead>
          <tr>
            <th>Date</th>
            <th>Time of Day</th>
            <th>Duration</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="recent-drives-table">
          <%= render partial: "session_row", collection: @recent_sessions, as: :session %>
        </tbody>
      </table>
      <% if Current.user.drive_sessions.completed.count > 3 %>
        <div class="view-all-link">
          <%= link_to "View All Drives", all_drive_sessions_path, class: "button" %>
        </div>
      <% end %>
    <% else %>
      <p class="empty-state">No drives recorded yet. Start your first drive!</p>
    <% end %>
  </div>
</div>

