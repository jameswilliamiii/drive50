<%= turbo_stream_from Current.user %>

<div class="dashboard">
  <%= render partial: "progress_summary", locals: {
    in_progress: @in_progress,
    total_hours: @total_hours,
    night_hours: @night_hours
  } %>

  <div class="drive-history">
    <h3>Recent Drives</h3>
    <% if Current.user.drive_sessions.completed.any? %>
      <table class="recent-drives-table-wrapper">
        <thead>
          <tr>
            <th>Date</th>
            <th>Time of Day</th>
            <th>Duration</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="recent-drives-table">
          <%= render partial: "session_row", collection: @recent_sessions, as: :session %>
        </tbody>
      </table>
      <% if Current.user.drive_sessions.completed.count > 3 %>
        <div class="view-all-link">
          <%= link_to "View All Drives", all_drive_sessions_path, class: "button" %>
        </div>
      <% end %>
    <% else %>
      <p class="empty-state">No drives recorded yet. Start your first drive!</p>
    <% end %>
  </div>
</div>

