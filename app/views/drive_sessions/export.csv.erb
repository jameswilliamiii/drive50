<%- headers = ["Date", "Start Time", "End Time", "Duration (hours)", "Night Drive", "Driver", "Notes"] -%>
<%= raw CSV.generate_line(headers) -%>
<%- @sessions.each do |session| -%>
<%-
  # Unescape any HTML entities in notes (fixes &quot; etc.)
  notes = session.notes.to_s
  notes = CGI.unescapeHTML(notes) if notes.present?
-%>
<%= raw CSV.generate_line([
  session.started_at.strftime("%m/%d/%Y"),
  session.started_at.strftime("%I:%M %p"),
  session.ended_at&.strftime("%I:%M %p"),
  session.duration_hours,
  session.is_night_drive ? "Yes" : "No",
  session.driver_name,
  notes
]) -%>
<%- end -%>

